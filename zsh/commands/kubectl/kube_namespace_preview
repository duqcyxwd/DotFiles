#!/bin/zsh

KUBECONFIG=${2:-$HOME/.kube/config}


# Method 1
#  "-------------------------------------------------------------------------------"

# echo "------------------------ PODS INFO --------------------------------------------"
# echo "-------------------------------------------------------------------------------"

# kubectl get pods --namespace $1 --kubeconfig $KUBECONFIG

# echo ""
# echo "----------------------- SERVICES INFO -----------------------------------------"
# echo "-------------------------------------------------------------------------------"

# kubectl get svc --namespace $1 --kubeconfig $KUBECONFIG


# echo ""
# echo "-------------------------------------------------------------------------------"
# echo "KUBECONFIG: " $KUBECONFIG


# Method 2
#  "-------------------------------------------------------------------------------"
f1=$(mktemp)
f2=$(mktemp)

# { kubectl get pods --namespace $1 --kubeconfig $KUBECONFIG } > $f1 &
# kgp_cached use to update cache
{ kgp_cached 0 $1 } > $f1 &
P1=$!

{ kubectl get svc --namespace $1 --kubeconfig $KUBECONFIG } > $f2 &
P2=$!

echo "------------------------ PODS INFO --------------------------------------------"
echo "-------------------------------------------------------------------------------"

wait $P1 && cat $f1

echo ""
echo "----------------------- SERVICES INFO -----------------------------------------"
echo "-------------------------------------------------------------------------------"


wait $P2 && cat $f2

echo ""
echo "-------------------------------------------------------------------------------"
echo "KUBECONFIG: " $KUBECONFIG
echo "NAMESPACE : " $(kcgcn)

rm $f1 $f2

